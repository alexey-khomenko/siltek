extends ../layouts/app

block title
    | Калькулятор вартості тонування водно-дисперсійних матеріалів ТМ SILTEK

block main
    - action = 'ajax.php';
    - link = '#';

    form(action=action, class="block-form-questions text-center bx-master-calculator-wrap", x-data="formData()", x-init="loadProducts()", @submit.prevent="console.log('submit')")
        table(x-show="step === 1")
            tbody
                tr
                    td(class="text-right")
                        | Продукт
                    td
                        select(name="product", @change="product = $event.target.value; loadColors();", :disabled="!products.length")
                            template(x-if="!product")
                                option
                            template(x-for="item in products", :key="item.id")
                                option(:value="item.id", x-text="item.name")
                    td(rowspan="4")
                        template(x-if="photo")
                            img(:src="photo")
                tr
                    td(class="text-right")
                        | Номер кольору
                    td
                        select(name="color", @change="color = $event.target.value; loadPacks()", :disabled="!colors.length")
                            template(x-if="!color")
                                option
                            template(x-for="item in colors", :key="item.id")
                                option(:value="item.id", x-text="item.name")
                tr
                    td(class="text-right")
                        | Тара
                    td
                        select(name="pack", @change="pack = $event.target.value; loadBases()", :disabled="!packs.length")
                            template(x-if="!pack")
                                option
                            template(x-for="item in packs", :key="item.id")
                                option(:value="item.id", x-text="item.name")
                tr
                    td(class="text-right")
                        | База
                    td
                        select(name="base", @change="base = $event.target.value; loadPigments()", :disabled="!bases.length")
                            template(x-if="!base")
                                option
                            template(x-for="item in bases", :key="item.id")
                                option(:value="item.id", x-text="item.name")

        table(x-show="step === 2", x-cloak)
            tbody
                tr
                    td
                        | Пігмент
                    td
                        | Кількість, мл
                    td
                        | Ціна пігменту, грн з ПДВ

                template(x-for="item in pigments")
                    tr
                        td(x-text="item.name")
                        td(x-text="item.quantity")
                        td(x-text="item.price")

                tr
                    td(colspan="2", class="text-right")
                        | Ціна пігментів, грн. з ПДВ
                    td(x-text="pigments_price")
                tr
                    td(colspan="2", class="text-right")
                        | Доплата за тонування, грн. з ПДВ
                    td(x-text="pigments_price_up")
                tr
                    td(colspan="2", class="text-right")
                        | Загальна вартість тонування, грн. з ПДВ
                    td(x-text="pigments_price_amount")
                tr
                    td(colspan="2", class="text-right")
                        | Рекомендована роздрібна вартість продукту-основи, грн. з ПДВ
                    td(x-text="base_price")
                tr
                    td(colspan="2", class="text-right")
                        | % знижки
                    td
                        input(name="base_discount", x-model="base_discount", @change="loadPigments()", class="text-center")
                tr
                    td(colspan="2", class="text-right")
                        | Вартість продукту-основи зі знижкою, грн з ПДВ
                    td(x-text="base_amount")
                tr
                    td(colspan="2", class="text-right")
                        | Сума, грн з ПДВ
                    td(x-text="amount")

        div(class="row between-xs", x-show="step === 1")
            div(class="col-xs-6 text-left")
                a(href=link, class="button gray-button")
                    | Назад
            div(class="col-xs-6 text-right")
                button(type="submit", class="button", :disabled="!pigments.length", @click="step = 2")
                    | Далі

        div(class="row between-xs", x-show="step === 2", x-cloak)
            div(class="col-xs-6 text-left")
                button(type="button", class="button gray-button", @click="step = 1")
                    | Назад
            div(class="col-xs-6 text-right")
                a(href=link, class="button")
                    | Готово

//-
    2 экрана
        - товар, цвет, тара,  фото (если хватает места)
        - пигменты, стоимость

    анимация сдвига
        - справо налево step 1 -> 2
        - и слева на право step 2 -> 1